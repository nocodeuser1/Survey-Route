@tailwind base;
@tailwind components;
@tailwind utilities;

/* Mobile-first optimizations */
@layer base {
  html {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    overflow-x: hidden;
    max-width: 100vw;
  }

  body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    overflow-x: hidden;
    max-width: 100vw;
  }

  #root {
    overflow-x: hidden;
    max-width: 100vw;
  }

  /* Improve touch targets for mobile */
  button,
  a {
    min-height: 44px;
    min-width: 44px;
  }

  /* Better mobile input styling */
  input,
  textarea,
  select {
    font-size: 16px;
    /* Prevents zoom on iOS */
  }

  /* Smooth scrolling */
  * {
    -webkit-overflow-scrolling: touch;
  }
}

/* Mobile-specific utilities */
@layer utilities {
  .touch-action-none {
    touch-action: none;
  }

  .touch-action-pan-x {
    touch-action: pan-x;
  }

  .touch-action-pan-y {
    touch-action: pan-y;
  }

  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}

@layer components {

  .form-input,
  .form-select,
  .form-textarea {
    @apply w-full px-4 py-3 rounded-xl border border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700/50 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 hover:bg-white dark:hover:bg-gray-700 disabled:opacity-60 disabled:cursor-not-allowed disabled:hover:bg-gray-50 dark:disabled:hover:bg-gray-700/50 transition-all duration-200 shadow-sm outline-none;
  }

  .form-select {
    @apply pr-10;
    /* Space for the dropdown arrow */
  }

  .form-label {
    @apply block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2;
  }
}

/* Signature canvas specific */
canvas {
  touch-action: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Ensure Leaflet map doesn't overlap modals */
.leaflet-pane,
.leaflet-top,
.leaflet-bottom,
.leaflet-control {
  z-index: 1 !important;
}

.leaflet-popup-pane {
  z-index: 10 !important;
}

/* Z-index hierarchy for application layers:
   1-10: Map elements (leaflet panes, controls)
   20-50: Base UI elements (buttons, headers)
       30: StickyStatsBar (with pointer-events-none on container)
       40: Navigation bar (sticky)
       50: SignaturePromptBar (with pointer-events-none, buttons have pointer-events-auto)
   1000: Map header/controls in fullscreen mode
   1100+: Dropdowns and menus from fullscreen map
   2000+: Modal overlays (Update Route, Export, Save/Load dialogs)

   Note: Fixed overlays use pointer-events-none to allow clicks through to content below
   Note: Modal overlays use z-[2000] to ensure they appear above all map UI elements
*/

/* Glass-like backdrop for spiderfied markers */
.spiderfy-glass-backdrop {
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}